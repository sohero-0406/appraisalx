<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeesite.modules.aa.dao.ExamResultsDetailDao">
	
	<!-- 查询数据
	<select id="findList" resultType="ExamResultsDetail">
		SELECT ${sqlMap.column.toSql()}
		FROM ${sqlMap.table.toSql()}
		<where>
			${sqlMap.where.toSql()}
		</where>
		ORDER BY ${sqlMap.order.toSql()}
	</select> -->

	<resultMap id="findDataMap" type="TechnologyInfo">
		<id property="id" column="id"></id>
		<result property="name" column="name"></result>
		<collection property="itemList" ofType="IdentifyTecDetail">
			<id property="technologyInfoId" column="technologyInfoId"></id>
			<result property="typeName" column="technologyInfoName"></result>
			<result property="stuOrTec" column="stuOrTec"></result>
			<result property="code" column="code"></result>
		</collection>
	</resultMap>
	<select id="getExamResults" resultMap="findDataMap">

			select
			 tecInfo.id,
			 tecInfo.name,
			 a.id  as technologyInfoId,
			 a.name as technologyInfoName,
			 a.stuOrTec as stuOrTec,
			 a.code,
			 a.deduct_num
			from
			((SELECT
			detail.id,
			tec.paper_id as stuOrTec,
			detail.degree,
			detail.deduct_num,
			detail.code,
			detail.technology_info_id,
			info.name
			from
			aa_identify_tec tec
			left join aa_identify_tec_detail detail on detail.indentity_tec_id = tec.id
			left join aa_technology_info info on info.id = detail.technology_info_id
			where tec.paper_id = '1151374360001810432' )
			UNION All
			(SELECT
			detail.id,
			tec.exam_user_id as stuOrTec,
			detail.degree,
			detail.deduct_num,
			detail.code,
			detail.technology_info_id,
			info.name
			from
			aa_identify_tec tec
			left join aa_identify_tec_detail detail on detail.indentity_tec_id = tec.id
			left join aa_technology_info info on info.id = detail.technology_info_id
			where tec.exam_user_id = '2000'  ) ) a
			left join aa_technology_info tecInfo on tecInfo.id = a.technology_info_id



	</select>
	
</mapper>