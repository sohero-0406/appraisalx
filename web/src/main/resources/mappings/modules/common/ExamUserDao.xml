<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeesite.modules.common.dao.ExamUserDao">
	
	<!-- 查询数据
	<select id="findList" resultType="ExamUser">
		SELECT ${sqlMap.column.toSql()}
		FROM ${sqlMap.table.toSql()}
		<where>
			${sqlMap.where.toSql()}
		</where>
		ORDER BY ${sqlMap.order.toSql()}
	</select> -->

	<update id="updateExamUserEndTime" >
		UPDATE common_exam_user
		set end_time = (NOW())
	    where
		end_time is null
		and exam_id = #{examId}
		and status = '0'
	</update>

	<select id="getExamUserScoreList" resultType="ExamUser">
	select
	  id,
	  exam_id,
      user_num,
      score,
      CEILING((( UNIX_TIMESTAMP(end_time)-UNIX_TIMESTAMP(start_time) )/60)) as duration
      from common_exam_user
      where
      exam_id = #{examId}
	</select>

</mapper>